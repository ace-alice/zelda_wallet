var e=Object.defineProperty,l=Object.defineProperties,t=Object.getOwnPropertyDescriptors,u=Object.getOwnPropertySymbols,a=Object.prototype.hasOwnProperty,n=Object.prototype.propertyIsEnumerable,o=(l,t,u)=>t in l?e(l,t,{enumerable:!0,configurable:!0,writable:!0,value:u}):l[t]=u;import{u as r,A as i,B as s,d,_ as c}from"./index-BPJ-OjF-.js";import{m as v,b as m,_ as V}from"./parseTools-Cj65jVal.js";function f(){const e=Vue.ref(),l=Vue.ref(!1),t=VueRouter.useRouter(),{billNo:u,tokenUsed:a}=Pinia.storeToRefs(r()),{getOrderDetail:n}=r(),{proxy:o}=Vue.getCurrentInstance(),s=Vue.reactive({methodUrl:"",methodPayload:"",isNuvei:0});function d(){c.value&&clearTimeout(c.value),c.value=null,i({billNo:u.value}).then((e=>{var l,u,a,n,r,i,s,v,m;(null==(l=e.data)?void 0:l.body)&&(1==+(null==(a=null==(u=e.data)?void 0:u.body)?void 0:a.status)?(null==(r=null==(n=e.data)?void 0:n.body)?void 0:r.url)?null==o||o.mittBus.emit("to3DsBus",{url:null==(s=null==(i=e.data)?void 0:i.body)?void 0:s.url,isNuvei:!0,nuveiCreq:null==(m=null==(v=e.data)?void 0:v.body)?void 0:m.creq}):t.push("/order/detail"):!c.value&&(c.value=setTimeout((()=>{d()}),2e3)))}))}const c=Vue.ref(null);return Vue.watch((()=>e.value),(e=>{e&&e.submit()})),Vue.onUnmounted((()=>{c.value&&clearTimeout(c.value),c.value=null})),{beforeTo3dsInit:function(e){return l=this,null,r=function*(){e.success?(a.value=!0,u.value=e.billNo,yield n(),1==+e.isNuvei?(Object.assign(s,{methodUrl:e.methodUrl,methodPayload:e.methodPayload,isNuvei:e.isNuvei}),d()):e.url&&(null==o||o.mittBus.emit("to3DsBus",{url:e.url,isNuvei:!1}))):t.push("/order/detail")},new Promise(((e,t)=>{var u=e=>{try{n(r.next(e))}catch(l){t(l)}},a=e=>{try{n(r.throw(e))}catch(l){t(l)}},n=l=>l.done?e(l.value):Promise.resolve(l.value).then(u,a);n((r=r.apply(l,null)).next())}));var l,r},loading:l,paymentNuveiOption:s,nuveiFormRef:e}}function p(){const e=Vue.ref(null),l=Vue.ref(null),t=Vue.ref(null),u=Vue.ref(null),a=Vue.ref(null);let n=0;return{expirationDateFormItemRef:e,securityCodeRef:l,emailAddressRef:t,phoneNumberRef:u,expirationDateChange:function(l,t){var u;if(l[0]&&+l[0]>1&&(t(""),n=0),l[1]&&+l.slice(0,2)>12)return t(l[0]),void(n=1);let a=l.replace(/[^0-9]+/g,"").split("");2===a.length&&n>2&&(a=[a[0]]),a.length>=2&&a.splice(2,0,"/");const o=a.join("");/^[0-9/]*$/.test(o)&&(t(o.slice(0,5)),n=o.slice(0,5).length),o.length<5?setTimeout((()=>e.value&&e.value.clearValidate())):null==(u=e.value)||u.validate("blur")},securityCodeChange:function(e,t){var u;const a=e.replace(/[^0-9]+/g,"").slice(0,4);t(a),a.length<3?setTimeout((()=>l.value&&l.value.clearValidate())):null==(u=l.value)||u.validate("blur")},emailAddressChange:function(e,l){var u;e&&/^[a-zA-Z0-9._-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,4}$/.test(e)?null==(u=t.value)||u.validate("blur"):setTimeout((()=>t.value&&t.value.clearValidate()))},phoneNumberChange:function(e,l){var t;const a=e.replace(/[^0-9]+/g,"").slice(0,11);l(a),a.length<6||a.length>11?setTimeout((()=>u.value&&u.value.clearValidate())):null==(t=u.value)||t.validate("blur")},creditCardNoRef:a,creditCardNoChange:function(l,t){var u;const n=l.replace(/[^0-9]+/g,"");t(s(n).slice(0,23)),d(n).hasLowLength?null==(u=e.value)||u.validate("blur"):setTimeout((()=>a.value&&a.value.clearValidate()))}}}const b={class:"payment-info"},h=(e=>(Vue.pushScopeId("data-v-8c1b10f8"),e=e(),Vue.popScopeId(),e))((()=>Vue.createElementVNode("div",{class:"welcome-logo logo-size"},null,-1))),y={class:"user-info"},g={class:"bottom-show"},N=Vue.defineComponent({name:"PaymentInfo"});const C=c(Vue.defineComponent(l(((e,l)=>{for(var t in l||(l={}))a.call(l,t)&&o(e,t,l[t]);if(u)for(var t of u(l))n.call(l,t)&&o(e,t,l[t]);return e})({},N),t({setup(e){const{userInfo:l}=Pinia.storeToRefs(r());return(e,t)=>{var u,a;const n=V;return Vue.openBlock(),Vue.createElementBlock("div",b,[h,Vue.createElementVNode("div",y,Vue.toDisplayString(Vue.unref(l).email?Vue.unref(v)(Vue.unref(l).email):Vue.unref(m)((null==(u=Vue.unref(l))?void 0:u.countryCode)||"",(null==(a=Vue.unref(l))?void 0:a.phoneNo)||"")),1),Vue.createElementVNode("div",g,[Vue.createElementVNode("div",null,[Vue.createElementVNode("div",null,Vue.toDisplayString(Vue.unref(l).amount)+Vue.toDisplayString(Vue.unref(l).billCurrency),1),Vue.createElementVNode("div",null,Vue.toDisplayString(e.$t("amount")),1)]),Vue.createElementVNode("div",null,[Vue.createVNode(n,{name:"enter",class:"icon-color"})]),Vue.createElementVNode("div",null,[Vue.createElementVNode("div",null,Vue.toDisplayString(Vue.unref(l).productName),1),Vue.createElementVNode("div",null,Vue.toDisplayString(e.$t("to")),1)])])])}}}))),[["__scopeId","data-v-8c1b10f8"]]);export{C as _,f as b,p as f};
